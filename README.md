# Discord Analytics Dashboard / Discord è®ºå›æ•°æ®åˆ†æçœ‹æ¿

> **âš ï¸ Attribution / ç‰¹åˆ«å£°æ˜**
>
> This project's code is **99% generated by Google Gemini**. I served as the architect and prompt engineer to bring this full-stack analysis tool to life.
>
> æœ¬é¡¹ç›®çš„ä»£ç  **99% ç”± Google Gemini ç”Ÿæˆ**ã€‚æˆ‘ä½œä¸ºæ¶æ„å¸ˆå’Œæç¤ºè¯å·¥ç¨‹å¸ˆï¼ˆPrompt Engineerï¼‰æ„å»ºäº†è¿™ä¸ªå…¨æ ˆåˆ†æå·¥å…·ã€‚

å¯æ”¶è´¹è¿›è¡Œéƒ¨ç½²
éœ€è¦è”ç³» Discord

`https://discord.gg/VQVJpQznfc`

---

Paid deployment service available
Contact via Discord

`https://discord.gg/VQVJpQznfc`


---

[English](#english) | [ä¸­æ–‡](#chinese)

---

<a name="english"></a>
## ğŸ‡ºğŸ‡¸ English Version

### Introduction
**Discord-Analytics-Dashboard** is a comprehensive tool designed to backup, analyze, and visualize activity within Discord Forum channels. It includes a Python-based data extraction pipeline and a Flask web dashboard that provides insights into user engagement, keyword trends, and member reports.

### Features
* **Data Backup:** Bulk download forum threads and member data using DiscordChatExporter.
* **Data Cleaning:** Merge and sanitize fragmented JSON data for analysis.
* **SQLite Integration:** Efficiently store and query millions of discord messages.
* **Web Dashboard:**
    * Server-wide statistics (Daily activity, word clouds).
    * Individual user profiles (Activity charts, interaction maps, rank).
    * Discord OAuth2 Login integration.
    * Admin panel for merging user accounts (e.g., old/new accounts).


### ğŸ“¸ Screenshots

| **Home / é¦–é¡µ** | **User Profile / ç”¨æˆ·** | **Admin Panel / ç®¡ç†å‘˜** |
|:---:|:---:|:---:|
| <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/Home.png" height="200px"> | <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/User%20Profile.png" height="200px"> | <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/admin.png" height="200px"> |

| **Login / ç™»å½•** | **Report / æŠ¥å‘Š** | **Report 2 / æŠ¥å‘Š 2** |
|:---:|:---:|:---:|
| <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/Login.png" height="200px"> | <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/Report1.png" height="200px"> | <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/Report2.png" height="200px"> |

| **Report 3 / æŠ¥å‘Š 3** | **Report 4 / æŠ¥å‘Š 4** | **Report 5 / æŠ¥å‘Š 5** |
|:---:|:---:|:---:|
| <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/Report3.png" height="200px"> | <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/Report4.png" height="200px"> | <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/Report5.png" height="200px"> |

### Prerequisites
1.  Python 3.8+
2.  [Tyrrrz/DiscordChatExporter](https://github.com/Tyrrrz/DiscordChatExporter) (CLI version recommended) installed and accessible.
3.  A Discord Bot Token or User Token (Use with caution).

### Installation & Usage

#### Step 1: Fetch IDs (`all_threads.py` & `members.py`)
First, get the list of threads and members. Open these files and configure:

```python
# In all_threads.py & members.py
TOKEN = "YOUR_BOT_OR_USER_TOKEN"
GUILD_ID = "YOUR_SERVER_ID"
FORUM_CHANNEL_ID = 1019924310665728022 # Your Forum Channel ID
```

#### Step 2: Backup Data (`backup_2025.py`)
This script uses `DiscordChatExporter.Cli` to download the actual chat history.

**Configuration:**
```python
# Path to your DiscordChatExporter CLI executable
# Please confirm the path is correct
DCE_PATH = r"E:\DiscordChatExporter.Cli.win-x64\DiscordChatExporter.Cli.exe"

# Add tokens (You can use multiple tokens to speed up or distribute load)
# Replace 'MTQ2MTI5' with your actual tokens
TOKENS = [
    {"name": "Bot 1", "token": "YOUR_TOKEN_1"},
    {"name": "Bot 2", "token": "YOUR_TOKEN_2"},
    # ... add more if needed
]
```

#### Step 3: Clean & Merge Data (`clean_json.py`)
Merge the downloaded individual JSON files into a single, clean dataset for analysis.

**Configuration:**
```python
CSV_FILE_PATH = "all_threads.csv" # Generated from Step 1
# Pattern to find your downloaded JSON files (Check your path)
JSON_FILES_PATTERN = r"E:\discord-backups1.5\discord-backups\backup\**\*.json"
OUTPUT_FILENAME = "merged_final_clean.json"
TARGET_CATEGORY_ID = "1019924310665728022"
```

#### Step 4: Import to Database (`disocrdDB.py`)
Import the merged JSON data into an SQLite database.

**Configuration:**
```python
# ================= Config =================
JSON_FILENAME = "merged_final_clean.json" # File from Step 3
DB_FILENAME = "discord_data.db"
SERVER_ID = "915249444721668096"
BATCH_SIZE = 5000  # Commit to DB every 5000 records
```

#### Step 5: Run the Web Dashboard (`app.py`)
Finally, configure and run the Flask application. You need to set up a Discord Application in the [Discord Developer Portal](https://discord.com/developers/applications) to get the Client ID and Secret.

**Configuration:**
```python
# ================= Config Area =================
app.secret_key = 'YOUR_SUPER_SECRET_KEY_CHANGE_THIS' # Change this!
app.permanent_session_lifetime = timedelta(days=30)

DB_DATABASE = 'discord_data.db'
SERVER_ID = "915249444721668096"
ITEMS_PER_PAGE = 100
CSV_FILENAME = 'members.csv' # Generated from Step 1
CACHE_FILE = 'cache_data_full.pkl'
CHECKPOINT_INTERVAL = 50
ADMIN_IDS = ["891196284998930522"] # List of Discord User IDs for Admin access

# Discord OAuth2 Settings
DISCORD_CLIENT_ID = "YOUR_CLIENT_ID"      # <--- Fill this
DISCORD_CLIENT_SECRET = "YOUR_CLIENT_SECRET"  # <--- Fill this
API_BASE_URL = '[https://discord.com/api/v10](https://discord.com/api/v10)'
```

Run the app:
```bash
python app.py
```
Visit `http://localhost:5000` in your browser.

---

<a name="chinese"></a>
## ğŸ‡¨ğŸ‡³ ä¸­æ–‡ç‰ˆæœ¬

### é¡¹ç›®ç®€ä»‹
**Discord-Analytics-Dashboard** æ˜¯ä¸€ä¸ªé’ˆå¯¹ Discord è®ºå›é¢‘é“è¿›è¡Œå…¨é‡å¤‡ä»½ã€æ•°æ®åˆ†æå’Œå¯è§†åŒ–å±•ç¤ºçš„å·¥å…·ã€‚å®ƒåŒ…å«äº†ä¸€å¥—å®Œæ•´çš„æ•°æ®æŠ“å–æµç¨‹å’Œä¸€ä¸ªåŸºäº Flask çš„ Web çœ‹æ¿ï¼Œç”¨äºå±•ç¤ºæˆå‘˜æ´»è·ƒåº¦ã€çƒ­é—¨è¯é¢˜è¯äº‘ä»¥åŠç”Ÿæˆå¹´åº¦æŠ¥å‘Šã€‚

### åŠŸèƒ½ç‰¹æ€§
* **æ•°æ®å¤‡ä»½:** ä½¿ç”¨ DiscordChatExporter æ‰¹é‡ä¸‹è½½è®ºå›å¸–å­ã€‚
* **æ•°æ®æ¸…æ´—:** å°†åˆ†æ•£çš„ JSON æ–‡ä»¶åˆå¹¶å¹¶æ¸…æ´—ï¼Œä¾¿äºåˆ†æã€‚
* **SQLite å­˜å‚¨:** é«˜æ•ˆå­˜å‚¨å’ŒæŸ¥è¯¢æ•°ç™¾ä¸‡æ¡èŠå¤©è®°å½•ã€‚
* **Web çœ‹æ¿:**
    * æœåŠ¡å™¨æ¦‚è§ˆï¼ˆæ¯æ—¥æ´»è·ƒåº¦è¶‹åŠ¿ã€å…¨æœè¯äº‘ï¼‰ã€‚
    * ä¸ªäººæ¡£æ¡ˆï¼ˆæ´»è·ƒåº¦å›¾è¡¨ã€äº’åŠ¨å…³ç³»å›¾ã€æ’åï¼‰ã€‚
    * é›†æˆ Discord OAuth2 ç™»å½•ã€‚
    * ç®¡ç†å‘˜åå°ï¼ˆæ”¯æŒåˆå¹¶æ–°æ—§è´¦å·æ•°æ®ï¼‰ã€‚

### ğŸ“¸ ç•Œé¢å±•ç¤º

| **Home / é¦–é¡µ** | **User Profile / ç”¨æˆ·** | **Admin Panel / ç®¡ç†å‘˜** |
|:---:|:---:|:---:|
| <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/Home.png" height="200px"> | <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/User%20Profile.png" height="200px"> | <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/admin.png" height="200px"> |

| **Login / ç™»å½•** | **Report / æŠ¥å‘Š** | **Report 2 / æŠ¥å‘Š 2** |
|:---:|:---:|:---:|
| <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/Login.png" height="200px"> | <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/Report1.png" height="200px"> | <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/Report2.png" height="200px"> |

| **Report 3 / æŠ¥å‘Š 3** | **Report 4 / æŠ¥å‘Š 4** | **Report 5 / æŠ¥å‘Š 5** |
|:---:|:---:|:---:|
| <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/Report3.png" height="200px"> | <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/Report4.png" height="200px"> | <img src="%E7%95%8C%E9%9D%A2%E6%BC%94%E7%A4%BA/Report5.png" height="200px"> |

### å‰ç½®è¦æ±‚
1.  Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2.  å®‰è£…å¹¶è§£å‹ [Tyrrrz/DiscordChatExporter](https://github.com/Tyrrrz/DiscordChatExporter) (æ¨è CLI ç‰ˆæœ¬)ã€‚
3.  ä¸€ä¸ª Discord æœºå™¨äºº Token æˆ–ç”¨æˆ· Token (è¯·æ³¨æ„è´¦å·å®‰å…¨)ã€‚

### å®‰è£…ä¸é…ç½®æ­¥éª¤

#### ç¬¬ä¸€æ­¥ï¼šè·å–æ•°æ®åˆ—è¡¨ (`all_threads.py` å’Œ `members.py`)
é¦–å…ˆè¿è¡Œè¿™ä¸¤ä¸ªè„šæœ¬æ¥è·å–æ‰€æœ‰å¸–å­çš„ ID å’Œæˆå‘˜åˆ—è¡¨ã€‚è¯·ä¿®æ”¹è„šæœ¬ä¸­çš„ä»¥ä¸‹å‚æ•°ï¼š

```python
# ä¿®æ”¹ all_threads.py å’Œ members.py
TOKEN = "ä½ çš„æœºå™¨äººæˆ–ç”¨æˆ·å¯†é’¥"
GUILD_ID = "ä½ çš„æœåŠ¡å™¨ID"
FORUM_CHANNEL_ID = 1019924310665728022 # ä½ çš„è®ºå›é¢‘é“ID
```

#### ç¬¬äºŒæ­¥ï¼šå¤‡ä»½èŠå¤©è®°å½• (`backup_2025.py`)
è¯¥è„šæœ¬è°ƒç”¨ DiscordChatExporter ä¸‹è½½å…·ä½“çš„èŠå¤©å†…å®¹ã€‚

**é…ç½®ä¿®æ”¹:**
```python
# è¯·ç¡®è®¤ DiscordChatExporter.Cli.exe çš„æœ¬åœ°è·¯å¾„æ˜¯å¦æ­£ç¡®
DCE_PATH = r"E:\DiscordChatExporter.Cli.win-x64\DiscordChatExporter.Cli.exe"

# å¸¦æœ‰åç§°çš„ Token é…ç½®ï¼Œå¯é…ç½®å¤šä¸ªä»¥åˆ†æ‹…ä¸‹è½½ä»»åŠ¡
# è¯·å°† 'MTQ2MTI5' æ›¿æ¢ä¸ºçœŸå®çš„ Token
TOKENS = [
    {"name": "ä¸‹è½½æœºå™¨äºº1", "token": "ä½ çš„å¯†é’¥1"},
    {"name": "ä¸‹è½½æœºå™¨äºº2", "token": "ä½ çš„å¯†é’¥2"},
    # ...
]
```

#### ç¬¬ä¸‰æ­¥ï¼šæ¸…æ´—ä¸åˆå¹¶æ•°æ® (`clean_json.py`)
å°†ä¸‹è½½ä¸‹æ¥çš„å¤§é‡åˆ†æ•£ JSON æ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªç”¨äºåˆ†æçš„å¤§æ–‡ä»¶ã€‚

**é…ç½®ä¿®æ”¹:**
```python
CSV_FILE_PATH = "all_threads.csv" # ç¬¬ä¸€æ­¥ç”Ÿæˆçš„ CSV
# ä¸‹è½½çš„ JSON æ–‡ä»¶æ‰€åœ¨è·¯å¾„ï¼Œæ”¯æŒé€šé…ç¬¦ (è¯·æ ¹æ®ä½ çš„å®é™…è·¯å¾„ä¿®æ”¹)
JSON_FILES_PATTERN = r"E:\discord-backups1.5\discord-backups\backup\**\*.json"
OUTPUT_FILENAME = "merged_final_clean.json"
TARGET_CATEGORY_ID = "1019924310665728022"
```

#### ç¬¬å››æ­¥ï¼šå¯¼å…¥æ•°æ®åº“ (`disocrdDB.py`)
å°†åˆå¹¶åçš„ JSON å­˜å…¥ SQLite æ•°æ®åº“ã€‚

**é…ç½®ä¿®æ”¹:**
```python
# ================= é…ç½® =================
JSON_FILENAME = "merged_final_clean.json" # ç¬¬ä¸‰æ­¥ç”Ÿæˆçš„æ–‡ä»¶å
DB_FILENAME = "discord_data.db"
SERVER_ID = "915249444721668096"
BATCH_SIZE = 5000  # æ¯å¤„ç†å¤šå°‘æ¡æ¶ˆæ¯å†™å…¥ä¸€æ¬¡ç¡¬ç›˜ (é˜²æ­¢å†…å­˜çˆ†ç‚¸)
```

#### ç¬¬äº”æ­¥ï¼šè¿è¡Œ Web çœ‹æ¿ (`app.py`)
æœ€åï¼Œé…ç½®å¹¶è¿è¡Œ Flask ç½‘ç«™ã€‚ä½ éœ€è¦å…ˆåœ¨ [Discord Developer Portal](https://discord.com/developers/applications) åˆ›å»ºåº”ç”¨ä»¥è·å– OAuth2 å‡­è¯ã€‚

**é…ç½®ä¿®æ”¹:**
```python
# ================= é…ç½®åŒº =================
app.secret_key = 'YOUR_SUPER_SECRET_KEY_CHANGE_THIS' # è¯·åŠ¡å¿…ä¿®æ”¹æ­¤éšæœºå­—ç¬¦ä¸²
app.permanent_session_lifetime = timedelta(days=30) # ç™»å½•ä¿æŒæ—¶é—´

DB_DATABASE = 'discord_data.db'
SERVER_ID = "915249444721668096"
ITEMS_PER_PAGE = 100
CSV_FILENAME = 'members.csv'
CACHE_FILE = 'cache_data_full.pkl'
CHECKPOINT_INTERVAL = 50
ADMIN_IDS = ["891196284998930522"] # ç®¡ç†å‘˜çš„ Discord User ID (å¡«å†™ä½ è‡ªå·±çš„)

# Discord OAuth2 é…ç½®
DISCORD_CLIENT_ID = "Client ID"  # <--- å¡«å…¥ä½ çš„ Client ID
DISCORD_CLIENT_SECRET = "Client Secret"  # <--- å¡«å…¥ä½ çš„ Client Secret
API_BASE_URL = '[https://discord.com/api/v10](https://discord.com/api/v10)'
```

è¿è¡Œé¡¹ç›®ï¼š
```bash
python app.py
```
åœ¨æµè§ˆå™¨ä¸­è®¿é—® `http://localhost:5000`ã€‚
